---
title: 安装黑苹果踩坑记录
date: 2018-08-02 00:42:31
tags:
  - macOS
  - 黑苹果
categories: 技术
---

最近给公司的 PC 装上了 macOS，出发点是13寸 mbp 确实性能不好，PC 闲置着又很浪费，而且这个13寸的mbp是我厚颜无耻跟领导蹭来的，一直不还也不好。来来回回折腾了几次，终于是几乎完美了，顺便还帮同事朱小哥也装了 macOS，i7-7700 + GTX1060 的 macOS High Sierra，配上开启了 HiDPI 的 Dell 2k 显示器，用来工作可以说是美滋滋了。

踩坑的过程痛苦又自得其乐，遂记录于此。

<!--more-->

# Prerequisites

首页，基本的安装教程来自以下这个链接:

[UniBeast: Install macOS High Sierra on Any Supported Intel-based PC](https://www.tonymacx86.com/threads/unibeast-install-macos-high-sierra-on-any-supported-intel-based-pc.235474/)

所以从标题上也可以看到了：

- 基于 Intel 体系的，所以 AMD 的芯片组和 CPU 就别想了
- PC，所以笔记本就别想了

另外，基于这个网站的教程，还有一个先决条件：

你得先有一台真 mac 机器，macbook pro 或者 iMac 之类的，因为U盘的制作需要在白苹果内完成（教程中有详细说明）

# Problems and solutions

## 制作U盘引导报错：copy of apfs.efi failed

这个问题是U盘没有 EFI 分区，可以在 Terminal 中执行：

```shell
sudo diskutil partitionDisk disk2 GPT JHFS+ USB R 
```

关于这个命令，diskutil 是 macOS 内置的命令行磁盘工具，建议学习一下啊，后面还有用到的地方，disk2 是你的U盘的节点，所以最好先用 `diskutil list` 这个命令查看一下当前U盘的节点，万一搞错了问题就很大了。

![](http://wx3.sinaimg.cn/large/8127619agy1ftuqzt6yrfj205i05cdfv.jpg)

## U盘启动后进不了 Recovery，屏幕显示一个禁止的符号

这其实一个多重问题，U盘的问题和 usb 接口的问题，我先是用了一个活动送的U盘，不管换哪个接口都不行，后来换了个闪迪的U盘，终于进安装界面了，中间还出现了一个问题，在给同事安装系统的过程中出现了一个镜像过期的提示，后来换了另外一个 usb 接口就OK了。

理论上来说最好选用2.0的U盘和2.0的 usb 接口，容易一次过。

## 对系统盘执行擦除时失败

因为很多 PC 都会对硬盘分区，所以到这一步骤有可能会出现这个问题，macOS 的图形化磁盘工具不是很好用，这个时候就要用到 diskutil 命令行工具啦

1. 执行 `diskutil list` 找到你要格式化的硬盘的节点，比如我的那块 ssd 是 disk0。
2. 执行 `diskutil eraseDisk JHFS+ macOS disk0`，JHFS+ 是 Mac OS Extended (Journaled) 格式，也就是教程中需要的格式，macOS是对磁盘重命名的名字，这个名字写什么全凭个人喜好了。

## 3.5mm 耳机接口用不了

虽然我用的是蓝牙耳机用不到这个接口，但是追求完美，这个问题还是要解决，在 MultiBeast 中配置 Audio 驱动时，选择 VoodooHDA，这是一个万能音频驱动。

## 显示器设置中没有 HiDPI选项

威锋网上有一篇靠谱的教程：[开启HiDPI（黑苹果通用。10.12.3通过）](https://bbs.feng.com/forum.php?mod=viewthread&tid=11104214)

要注意一点是那个配置文件是没有后缀的，一开始我怎么弄都不对是因为文件后缀被隐藏了。

亲测 25寸的 2k 显示器 开启 1920*1080 的 HiDPI 效果最好。

## 显存数值不对

1060 的 3GB 的显存显示 256MB，编辑 EFI 分区里的 config.plist 文件（至于怎么挂载 EFI 分区怎么修改这个文件，字数够另写一篇blog了，懒得细说了），把其中的 Inject Nvidia 改为 false。

## 无线网卡不识别

这个真没办法了，板载的无线网卡没有驱动，真的有这个需求只能去买一个 usb 外置网卡或者 PCIe的无线网卡，或许有用，反正办公室的 PC 都是插网线的，所以这个问题真的不大。

# 成果

![](http://wx2.sinaimg.cn/large/8127619agy1ftusidjuy1j21kw0w0dm7.jpg)

就一句话，工作开心最重要